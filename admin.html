<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Admin Panel — Honest News</title>
  <style>
    :root{--bg:#0b1220;--card:#071227;--muted:#9fb0c8;--accent:#06b6d4;--glass:rgba(255,255,255,0.03)}
    html,body{height:100%;margin:0;background:var(--bg);font-family:Inter,ui-sans-serif,system-ui,-apple-system,'Segoe UI',Roboto,'Helvetica Neue',Arial;color:#e6eef6}
    .btn{background:var(--accent);border:none;color:#022;padding:8px 12px;border-radius:8px;cursor:pointer}
    .btn.secondary{background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--muted)}
    input,select,textarea{padding:8px;border-radius:6px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:inherit;width:100%}
    .small{font-size:13px;color:var(--muted)}
    .grid{display:grid;grid-template-columns:320px 1fr;gap:16px;margin:20px}
    .card{background:var(--card);border-radius:12px;padding:12px;box-shadow:0 6px 20px rgba(2,6,23,0.6)}
    .list-item{display:flex;align-items:center;justify-content:space-between;padding:8px;border-radius:8px;background:var(--glass);margin-bottom:8px}
    .hero-preview{height:160px;border-radius:8px;background:#031220;display:flex;align-items:center;justify-content:center;color:var(--muted);position:relative;overflow:hidden}
    .hero-preview img{position:absolute;inset:0;width:100%;height:100%;object-fit:cover;filter:brightness(.4)}
  </style>
</head>
<body>

<!-- LOGIN PANEL -->
<div id="adminLogin" style="display:flex;flex-direction:column;align-items:center;justify-content:center;height:100vh;">
  <label>Password</label>
  <input type="password" id="adminPassword" placeholder="Enter password">
  <button id="loginBtn" class="btn">Log In</button>
  <div id="loginMsg" style="color:red;margin-top:8px"></div>
</div>

<!-- ADMIN PANEL -->
<div id="adminPanel" style="display:none">
  <div class="grid">
    <aside class="card">
      <label>Global Settings</label>
      <div><input type="checkbox" id="transparentHeader"><label class="small"> Transparent header on all pages</label></div>

      <hr>
      <label>Image Library</label>
      <input type="file" id="imageUpload" accept="image/*" multiple>
      <div id="imageLibrary" class="list"></div>

      <hr>
      <label>Site Data</label>
      <button id="downloadJson" class="btn">Download data.json</button>
      <button id="loadRemote" class="btn secondary">Reload from remote</button>
    </aside>

    <main class="card">
      <section>
        <label>Pages — Page Manager</label>
        <div style="display:flex;gap:8px;margin-bottom:8px">
          <input id="newTitle" type="text" placeholder="Page title">
          <input id="newSlug" type="text" placeholder="slug">
          <button id="addPage" class="btn">Add page</button>
        </div>
        <div id="pagesList" class="list"></div>
      </section>

      <hr>

      <section id="pageEditor" style="display:none">
        <h3 id="editingTitle">Editing — </h3>
        <div class="controls">
          <button id="saveBtn" class="btn">Save</button>
          <button id="deletePageBtn" class="btn secondary">Delete</button>
        </div>

        <label>Hero</label>
        <select id="heroBehavior">
          <option value="still">Still Image</option>
          <option value="parallax">Slow Parallax Scroll</option>
          <option value="carousel">Auto-Rotating Slides</option>
          <option value="video">Embedded Video</option>
          <option value="none">None</option>
        </select>

        <label>Hero Size</label>
        <select id="heroSize">
          <option value="small">Small</option>
          <option value="medium">Medium</option>
          <option value="large">Large</option>
          <option value="full">Full screen</option>
        </select>

        <label>Hero Media URL</label>
        <input id="heroMedia" type="text" placeholder="Image or video URL">

        <label>Parallax</label>
        <input type="checkbox" id="heroParallax">

        <label>Slides (carousel)</label>
        <div id="slidesEditor"></div>

        <div class="hero-preview" id="heroPreview">Hero Preview</div>

        <hr>

        <label>Page content — Rich text blocks</label>
        <input id="newBlockTitle" type="text" placeholder="Block name">
        <button id="addBlock" class="btn secondary">Add block</button>
        <div id="blocksList" class="list"></div>

        <hr>

        <label>Page colors</label>
        <input type="color" id="pageBgColor" title="Background color">
        <input type="color" id="pageTextColor" title="Text color">

        <hr>

        <label>JSON Preview</label>
        <pre id="jsonPreview"></pre>
      </section>
    </main>
  </div>
</div>

<script>
// --- ADMIN PANEL LOGIC ---

let data = null;
let editingPageId = null;
const ADMIN_PASSWORD = "password123"; // ← CHANGE THIS PASSWORD

function uid(){return 'id-'+Math.random().toString(36).slice(2,9)}
function q(id){return document.getElementById(id)}
function escapeHtml(s){ return (s+'').replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;') }

// --- LOGIN ---
q('loginBtn').addEventListener('click',()=>{
  const pass = q('adminPassword').value;
  if(pass === ADMIN_PASSWORD){
    q('adminLogin').style.display='none';
    q('adminPanel').style.display='block';
    initAdmin();
  } else {
    q('loginMsg').textContent='Wrong password!';
  }
});

// --- INIT ADMIN ---
function initAdmin(){
  const local = localStorage.getItem('static_admin_data');
  if(local) data = JSON.parse(local);
  else data = { settings:{transparentHeader:false}, images:[], pages:[] };
  renderAll();
}

// --- RENDER ---
function renderAll(){
  renderPages();
  renderImages();
  q('jsonPreview').textContent = JSON.stringify(data,null,2);
}

// Pages
function renderPages(){
  const node = q('pagesList');
  node.innerHTML='';
  data.pages.forEach(p=>{
    const el = document.createElement('div'); el.className='list-item';
    el.innerHTML=`<strong>${escapeHtml(p.title)}</strong><div class="small">${escapeHtml(p.slug)}</div>`;
    const edit = document.createElement('button'); edit.className='btn secondary'; edit.textContent='Edit';
    edit.onclick=()=>openEditor(p.id);
    const del = document.createElement('button'); del.className='btn secondary'; del.textContent='Del';
    del.onclick=()=>{ if(confirm('Delete page?')){ data.pages = data.pages.filter(x=>x.id!==p.id); saveLocal(); renderPages(); if(editingPageId===p.id) closeEditor(); } };
    el.appendChild(edit); el.appendChild(del);
    node.appendChild(el);
  });
}

// --- LOCAL STORAGE SAVE ---
function saveLocal(){ localStorage.setItem('static_admin_data',JSON.stringify(data)); q('jsonPreview').textContent=JSON.stringify(data,null,2); }

// --- OPEN / CLOSE EDITOR ---
function openEditor(id){
  editingPageId=id;
  const page = data.pages.find(p=>p.id===id);
  if(!page) return;
  q('pageEditor').style.display='block';
  q('editingTitle').textContent='Editing — '+page.title;
  q('heroBehavior').value = page.hero.behavior || 'still';
  q('heroSize').value = page.hero.size || 'medium';
  q('heroMedia').value = page.hero.media || '';
  q('heroParallax').checked = !!page.hero.parallax;
  q('pageBgColor').value = page.styles?.background || '#ffffff';
  q('pageTextColor').value = page.styles?.text || '#000000';
}

// --- ADD PAGE ---
q('addPage').addEventListener('click',()=>{
  const t = q('newTitle').value.trim()||'Untitled';
  const s = q('newSlug').value.trim()||('/'+t.toLowerCase().replace(/[^a-z0-9]+/g,'-'));
  const p = {id:uid(), title:t, slug:s, hero:{behavior:'still',size:'medium',media:'',parallax:false,slides:[]}, blocks:[], styles:{background:'#ffffff',text:'#000000'}};
  data.pages.push(p);
  saveLocal();
  renderAll();
  openEditor(p.id);
  q('newTitle').value=''; q('newSlug').value='';
});

// --- SAVE PAGE ---
q('saveBtn').addEventListener('click',()=>{
  if(!editingPageId) return alert('Open a page');
  const page = data.pages.find(p=>p.id===editingPageId);
  page.hero.behavior = q('heroBehavior').value;
  page.hero.size = q('heroSize').value;
  page.hero.media = q('heroMedia').value;
  page.hero.parallax = q('heroParallax').checked;
  page.styles.background = q('pageBgColor').value;
  page.styles.text = q('pageTextColor').value;
  saveLocal();
  renderAll();
});

// --- DOWNLOAD JSON ---
q('downloadJson').addEventListener('click',()=>{
  const blob = new Blob([JSON.stringify(data,null,2)],{type:'application/json'});
  const url = URL.createObjectURL(blob);
  const a=document.createElement('a'); a.href=url; a.download='data.json'; a.click(); URL.revokeObjectURL(url);
});

// --- IMAGE UPLOAD ---
q('imageUpload').addEventListener('change', async(e)=>{
  const files = Array.from(e.target.files);
  for(const f of files){
    const url = await new Promise(res=>{
      const r=new FileReader(); r.onload=()=>res(r.result); r.readAsDataURL(f);
    });
    data.images.unshift({id:uid(),name:f.name,url});
  }
  saveLocal(); renderAll();
  e.target.value='';
});
</script>

</body>
</html>






