<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Honest News Admin Panel</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body { font-family: system-ui, -apple-system, sans-serif; margin: 0; background: #f0f0f0; }
    #login { display: flex; align-items: center; justify-content: center; height: 100vh; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; }
    #login-box { background: white; padding: 40px; border-radius: 12px; box-shadow: 0 10px 30px rgba(0,0,0,0.2); text-align: center; width: 300px; color: #333; }
    input { width: 100%; padding: 12px; margin: 10px 0; border: 1px solid #ddd; border-radius: 6px; box-sizing: border-box; }
    button { width: 100%; padding: 12px; background: #4CAF50; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 16px; }
    button:hover { background: #45a049; }
    #error { color: #f44336; margin-top: 10px; }
    #dashboard { display: none; height: 100vh; overflow: hidden; }
    .header { background: white; padding: 20px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); display: flex; justify-content: space-between; align-items: center; }
    .content { display: flex; height: calc(100vh - 80px); }
    .sidebar { width: 250px; background: white; border-right: 1px solid #ddd; padding: 20px; overflow-y: auto; }
    .main { flex: 1; padding: 20px; overflow-y: auto; }
    .tab { padding: 10px; margin: 5px 0; cursor: pointer; border-radius: 4px; }
    .tab.active { background: #e3f2fd; }
    .blocks { min-height: 300px; border: 2px dashed #ddd; padding: 20px; border-radius: 8px; margin: 20px 0; }
    .block { background: #f9f9f9; padding: 15px; margin: 10px 0; border-radius: 6px; position: relative; border: 1px solid #eee; }
    .block:hover { border-color: #4CAF50; }
    .block-tools { position: absolute; top: -10px; right: 0; background: white; padding: 5px; border-radius: 4px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); display: none; }
    .block:hover .block-tools { display: block; }
    .block-tools button { background: none; border: none; cursor: pointer; margin: 0 2px; font-size: 14px; }
    #preview { width: 100%; height: 400px; border: 1px solid #ddd; border-radius: 6px; margin-top: 20px; }
    .hero-preview { max-width: 100%; border-radius: 8px; margin: 10px 0; }
  </style>
</head>
<body>

<div id="login">
  <div id="login-box">
    <h2>Honest News Admin</h2>
    <input type="password" id="password" placeholder="Enter password">
    <button id="login-btn">Log In</button>
    <div id="error"></div>
  </div>
</div>

<div id="dashboard">
  <div class="header">
    <h2>Admin Dashboard</h2>
    <button id="save-all">Save All</button>
  </div>
  <div class="content">
    <div class="sidebar">
      <h3>Pages</h3>
      <div id="pages-list"></div>
      <button id="new-page">+ New Page</button>
      <hr>
      <div class="tab active" data-tab="editor">Page Editor</div>
      <div class="tab" data-tab="hero">Hero Settings</div>
    </div>
    <div class="main">
      <div id="editor-tab">
        <h3 id="current-page">Select a page to edit</h3>
        <div class="blocks" id="blocks-container"></div>
        <button id="add-block">+ Add Block</button>
        <iframe id="preview" src="data:text/html,<h1>Preview loads here</h1>"></iframe>
      </div>
      <div id="hero-tab" style="display: none;">
        <h3>Hero for <span id="hero-page"></span></h3>
        <select id="hero-page-select"></select>
        <select id="hero-type">
          <option value="none">None</option>
          <option value="image">Image (Parallax)</option>
          <option value="video">Video</option>
        </select>
        <input type="text" id="hero-url" placeholder="URL for image/video">
        <label><input type="checkbox" id="parallax-toggle"> Parallax Effect</label>
        <div id="hero-preview"></div>
        <button id="save-hero">Save Hero</button>
      </div>
    </div>
  </div>
</div>

<script>
  const PASSWORD = 'admin2025';
  let data = JSON.parse(localStorage.getItem('honestnews-data') || '{"pages":[{"id":"home","title":"Home","blocks":[]}],"heroes":{}}');
  let currentPage = null;

  // Login
  document.getElementById('login-btn').addEventListener('click', () => {
    const input = document.getElementById('password').value;
    if (input === PASSWORD) {
      document.getElementById('login').style.display = 'none';
      document.getElementById('dashboard').style.display = 'block';
      init();
    } else {
      document.getElementById('error').textContent = 'Wrong password. Hint: admin2025';
    }
  });

  function init() {
    renderPages();
    renderHeroSelect();
    switchTab('editor');
  }

  function save() {
    localStorage.setItem('honestnews-data', JSON.stringify(data));
  }

  // Pages
  function renderPages() {
    const list = document.getElementById('pages-list');
    list.innerHTML = '';
    data.pages.forEach(page => {
      const div = document.createElement('div');
      div.className = 'tab';
      div.textContent = page.title;
      div.onclick = () => loadPage(page.id);
      list.appendChild(div);
    });
  }

  document.getElementById('new-page').addEventListener('click', () => {
    const title = prompt('Page title?');
    if (title) {
      const id = Date.now().toString(36);
      data.pages.push({id, title, blocks: []});
      save();
      renderPages();
      loadPage(id);
    }
  });

  function loadPage(id) {
    currentPage = data.pages.find(p => p.id === id);
    document.getElementById('current-page').textContent = `Editing: ${currentPage.title}`;
    renderBlocks();
    updatePreview();
  }

  // Blocks
  document.getElementById('add-block').addEventListener('click', () => {
    if (!currentPage) return;
    const type = prompt('Type: heading, paragraph, image');
    if (type) {
      currentPage.blocks.push({type, content: type === 'image' ? '' : 'New ' + type});
      renderBlocks();
      save();
      updatePreview();
    }
  });

  function renderBlocks() {
    const container = document.getElementById('blocks-container');
    container.innerHTML = '';
    currentPage.blocks.forEach((block, index) => {
      const div = document.createElement('div');
      div.className = 'block';
      if (block.type === 'heading') div.innerHTML = `<h2 contenteditable="true">${block.content || ''}</h2>`;
      if (block.type === 'paragraph') div.innerHTML = `<p contenteditable="true">${block.content || ''}</p>`;
      if (block.type === 'image') div.innerHTML = `<img src="${block.content}" style="max-width:100%;"><input type="text" value="${block.content}" onchange="updateBlock(${index}, this.value)" placeholder="Image URL">`;
      div.querySelector('[contenteditable]')?.addEventListener('blur', (e) => {
        block.content = e.target.innerText;
        save();
        updatePreview();
      });
      const tools = document.createElement('div');
      tools.className = 'block-tools';
      tools.innerHTML = `<button onclick="moveBlock(${index}, -1)">↑</button><button onclick="moveBlock(${index}, 1)">↓</button><button onclick="deleteBlock(${index})">×</button>`;
      div.appendChild(tools);
      container.appendChild(div);
    });
  }

  function updateBlock(index, content) {
    currentPage.blocks[index].content = content;
    renderBlocks();
    save();
    updatePreview();
  }

  function moveBlock(index, dir) {
    const block = currentPage.blocks.splice(index, 1)[0];
    currentPage.blocks.splice(index + dir, 0, block);
    renderBlocks();
    save();
    updatePreview();
  }

  function deleteBlock(index) {
    if (confirm('Delete?')) {
      currentPage.blocks.splice(index, 1);
      renderBlocks();
      save();
      updatePreview();
    }
  }

  // Hero
  function renderHeroSelect() {
    const select = document.getElementById('hero-page-select');
    select.innerHTML = '';
    data.pages.forEach(page => {
      const option = document.createElement('option');
      option.value = page.id;
      option.textContent = page.title;
      select.appendChild(option);
    });
    select.onchange = loadHero;
    loadHero();
  }

  function loadHero() {
    const id = document.getElementById('hero-page-select').value;
    const hero = data.heroes[id] || {type: 'none', url: '', parallax: false};
    document.getElementById('hero-type').value = hero.type;
    document.getElementById('hero-url').value = hero.url;
    document.getElementById('parallax-toggle').checked = hero.parallax;
    showHeroPreview(hero);
  }

  document.getElementById('save-hero').addEventListener('click', () => {
    const id = document.getElementById('hero-page-select').value;
    data.heroes[id] = {
      type: document.getElementById('hero-type').value,
      url: document.getElementById('hero-url').value,
      parallax: document.getElementById('parallax-toggle').checked
    };
    save();
    loadHero();
    if (currentPage && currentPage.id === id) updatePreview();
  });

  function showHeroPreview(hero) {
    const preview = document.getElementById('hero-preview');
    if (hero.type === 'image') {
      preview.innerHTML = `<img src="${hero.url}" class="hero-preview" style="display: block;">`;
    } else if (hero.type === 'video') {
      preview.innerHTML = `<video src="${hero.url}" controls class="hero-preview" style="display: block;"></video>`;
    } else {
      preview.innerHTML = '';
    }
  }

  // Preview
  function updatePreview() {
    if (!currentPage) return;
    const hero = data.heroes[currentPage.id] || {type: 'none', url: '', parallax: false};
    let html = '<!DOCTYPE html><html><head><style>body{margin:0;font-family:sans-serif;}.parallax{background-attachment:fixed;}</style></head><body>';
    if (hero.type === 'image' && hero.url) {
      html += `<div class="${hero.parallax ? 'parallax' : ''}" style="height:60vh;background:url(${hero.url}) center/cover; color:white; display:flex; align-items:center; justify-content:center;"><h1 style="text-shadow:2px 2px 4px #000;">${currentPage.title}</h1></div>`;
    }
    currentPage.blocks.forEach(block => {
      if (block.type === 'heading') html += `<h2 style="text-align:center;padding:20px;">${block.content}</h2>`;
      if (block.type === 'paragraph') html += `<p style="max-width:600px;margin:20px auto;">${block.content}</p>`;
      if (block.type === 'image') html += `<img src="${block.content}" style="max-width:100%;display:block;margin:20px auto;">`;
    });
    html += '</body></html>';
    const blob = new Blob([html], {type: 'text/html'});
    document.getElementById('preview').src = URL.createObjectURL(blob);
  }

  // Tabs
  function switchTab(tab) {
    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
    event?.target.classList.add('active');
    document.getElementById('editor-tab').style.display = tab === 'editor' ? 'block' : 'none';
    document.getElementById('hero-tab').style.display = tab === 'hero' ? 'block' : 'none';
  }

  document.querySelectorAll('.tab').forEach(tab => {
    tab.addEventListener('click', (e) => switchTab(e.target.dataset.tab));
  });

  // Global Save
  document.getElementById('save-all').addEventListener('click', save);

  // Auto-save on input
  document.addEventListener('input', () => { if (currentPage) save(); });
</script>

</body>
</html>














